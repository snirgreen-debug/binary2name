push    rbp
mov     rbp, rsp
sub     rsp, 10h
mov     [rbp+value], edi
mov     [rbp+length], esi
mov     eax, 10h
sub     eax, [rbp-8]
mov     edx, eax
mov     eax, cs:bi_valid
cmp     edx, eax
jge     loc_401DA6
mov     eax, cs:bi_valid
mov     edx, [rbp-4]
mov     ecx, eax
shl     edx, cl
mov     eax, edx
mov     edx, eax
movzx   eax, cs:bi_buf
or      eax, edx
mov     cs:bi_buf, ax
mov     eax, cs:outcnt
cmp     eax, 3FFDh
ja      short loc_401D08
mov     eax, cs:outcnt
lea     edx, [rax+1]
mov     cs:outcnt, edx
movzx   edx, cs:bi_buf
mov     eax, eax
mov     ds:outbuf[rax], dl
mov     eax, cs:outcnt
lea     edx, [rax+1]
mov     cs:outcnt, edx
movzx   edx, cs:bi_buf
shr     dx, 8
mov     eax, eax
mov     ds:outbuf[rax], dl
jmp     short loc_401D6C
mov     eax, cs:outcnt
lea     edx, [rax+1]
mov     cs:outcnt, edx
movzx   edx, cs:bi_buf
mov     eax, eax
mov     ds:outbuf[rax], dl
mov     eax, cs:outcnt
cmp     eax, 4000h
jnz     short loc_401D38
call    flush_outbuf
mov     eax, cs:outcnt
lea     edx, [rax+1]
mov     cs:outcnt, edx
movzx   edx, cs:bi_buf
shr     dx, 8
mov     eax, eax
mov     ds:outbuf[rax], dl
mov     eax, cs:outcnt
cmp     eax, 4000h
jnz     short loc_401D6C
call    flush_outbuf
mov     eax, [rbp-4]
movzx   edx, ax
mov     eax, cs:bi_valid
mov     ecx, 10h
sub     ecx, eax
mov     eax, ecx
mov     ecx, eax
sar     edx, cl
mov     eax, edx
mov     cs:bi_buf, ax
mov     eax, cs:bi_valid
mov     edx, eax
mov     eax, [rbp-8]
add     eax, edx
sub     eax, 10h
mov     cs:bi_valid, eax
jmp     short loc_401DD8
mov     eax, cs:bi_valid
mov     edx, [rbp-4]
mov     ecx, eax
shl     edx, cl
mov     eax, edx
mov     edx, eax
movzx   eax, cs:bi_buf
or      eax, edx
mov     cs:bi_buf, ax
mov     edx, cs:bi_valid
mov     eax, [rbp-8]
add     eax, edx
mov     cs:bi_valid, eax
nop
leave
retn